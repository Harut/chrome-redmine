<html>
<head><title>Quick Redmine - Options Page</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="options.css"/>

<script type="text/javascript">
	// Сохраняем настройки в localStorage
	function save_options() {
	    
		var page_state = document.getElementById('page_state');
		
		page_state.innerHTML = "";

		/* REDMINE URL */ 
		var redmine_url = document.getElementById('redmine_url').value;
		if (redmine_url) {
			page_state.innerHTML += "Пустой URL. ";
            page_state.style.color = 'red';
			return;
		} else {
			localStorage["redmine_url"] = redmine_url;
		}
		
		/* INTERVAL UPDATE */ 
		var interval_upd = document.getElementById('interval_upd').value;
		if (interval_upd) {
            page_state.innerHTML += "Не указан интервал. ";
            page_state.style.color = 'red';
			return;
		} else {
			localStorage["interval_upd"] = interval_upd;
		}
		
        page_state.innerHTML = "Сохранено.";		
	}

	// Восстанавливаем сохраненные ранее опции из localStorage
	function restore_options() {
		
		/* REDMINE URL */
		var redmine_url = localStorage["redmine_url"];
		if (redmine_url) {
			document.getElementById('redmine_url').setAttribute("value", redmine_url);
		}
		
		/* INTERVAL UPDATE */
		var interval_upd = localStorage["interval_upd"];
		if (interval_upd) {
			document.getElementById('interval_upd').setAttribute("value", interval_upd);
		}
		
		
		var inputs = document.getElementsByTagName('input');

        for (var i=0; i<inputs.length; i++) {
            if (inputs[i].type == 'text' || inputs[i].type == 'number') {
                inputs[i].onfocus = function() {
                    this.parentNode.parentNode.className = 'focus';
                }
                inputs[i].onblur = function() {
                    this.parentNode.parentNode.className = '';
                }
            }
        }
	}

	

</script>

</head>
<body onload="restore_options()">

<div id="wrapper">

    <h1 class="page_title">Redmine Extansions</h1>
    
    
    
    <div class="inner_wrapper">
        <p>Авторы и другая текстовая инфа, аля Welcome ;)</p>
        <h2 class="section_title">Настройки</h2>
        <ul class="options">
            <li class="">
                <div class="option">
                    <label for="redmine_url">URL на Redmine:</label>
                    <input id="redmine_url" type="text" size="60" />
                </div>
            </li>
            <li>
                <div class="option">
                    <label for="interval_upd">Интервал обновлений (в мин):</label>
                    <input id="interval_upd" class="small" type="number" size="5"  />
                </div>
            </li>
            <li class="">
                <div class="option">
                    <label for="redmine_url">Строка для фильтра:</label>
                    <input id="redmine_url" type="text" size="60" />
                    <small>будет использоваться для запроса к API Redmine.</small>
                </div>
            </li>
            <li class="buttons">
                <input name="commit" type="button" onclick="save_options()" value="Сохранить"/>
                <span id="page_state"></span>
            </li>
        </ul>
    </div>
</div>

</body>
</html>